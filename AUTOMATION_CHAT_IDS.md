# Настройка ID чатов для автоматических действий

## Обзор

Теперь можно настраивать ID чатов для каждого автоматического действия отдельно через Google таблицу. Это позволяет отправлять разные типы сообщений в разные чаты.

## Структура таблицы

В листе "Конфиг" в разделе "Автоматические сообщения" добавлен новый столбец **"ID чата"**:

| Автоматическое сообщение | ID топика | **ID чата** | Анонимный | Множественный выбор | Комментарий |
|-------------------------|-----------|-------------|-----------|---------------------|-------------|
| Опросы на игры | 1282 | | | | |
| Анонсы игр | | 123456789 | | | |
| Уведомления об изменениях | | 123456789,987654321 | | | |

## Логика работы

### 1. Если столбец "ID чата" пустой:
- Используется значение из GitHub Secrets (`CHAT_ID`)
- Если в Secrets тоже пусто → сообщение **не отправляется**

### 2. Если столбец "ID чата" заполнен:
- Сообщение отправляется **и в чаты из таблицы, и в чаты из Secrets**
- Объединяются оба списка (без дубликатов)
- Если в Secrets пусто → отправляется только в чаты из таблицы

### 3. Несколько ID через запятую:
- Можно указать несколько чатов: `123456789,987654321,111111111`
- Или через пробел: `123456789 987654321 111111111`
- Сообщение будет отправлено в **каждый** указанный чат

## Примеры использования

### Пример 1: Опросы в основной чат, анонсы в другой
```
Опросы на игры    | 1282 | (пусто)           | → использует Secrets
Анонсы игр        |      | 987654321         | → отправляет в 987654321 + Secrets
```

### Пример 2: Все в один чат из таблицы
```
Опросы на игры    | 1282 | 123456789         | → отправляет в 123456789 + Secrets
Анонсы игр        |      | 123456789         | → отправляет в 123456789 + Secrets
```

### Пример 3: Разные чаты для разных действий
```
Опросы на игры    | 1282 | 111111111         | → отправляет в 111111111 + Secrets
Анонсы игр        |      | 222222222         | → отправляет в 222222222 + Secrets
Уведомления       |      | 333333333,444444444 | → отправляет в 333333333, 444444444 + Secrets
```

### Пример 4: Только Secrets (классический вариант)
```
Опросы на игры    | 1282 | (пусто)           | → использует только Secrets
Анонсы игр        |      | (пусто)           | → использует только Secrets
```

## Обновление структуры таблицы

При первом запуске или при обновлении конфигурации столбец "ID чата" будет автоматически добавлен в таблицу.

Для ручного обновления:
```bash
python update_automation_config.py
```

## Важно

- Если и в таблице пусто, и в Secrets пусто → сообщения **не отправляются**
- ID чатов из таблицы имеют приоритет (добавляются первыми в список)
- Дубликаты автоматически удаляются
- Поддерживаются как положительные, так и отрицательные ID (для групп)

## Поддерживаемые автоматические действия

- ✅ **GAME_POLLS** - Опросы на игры
- ✅ **GAME_ANNOUNCEMENTS** - Анонсы игр
- ✅ **GAME_UPDATES** - Уведомления об изменениях
- ✅ **CALENDAR_EVENTS** - Календарные события
- ✅ **BIRTHDAY_NOTIFICATIONS** - Уведомления о днях рождения

